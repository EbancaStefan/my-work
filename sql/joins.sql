USE written
GO

CREATE TABLE S1(
FK1 INT,
FK2 INT,
A VARCHAR(100),
B VARCHAR(100),
C VARCHAR(100),
D VARCHAR(100),
E INT,
PRIMARY KEY(FK1,FK2)
)

INSERT INTO S1 VALUES(1, 1,' a1', 'b1', 'c1', 7, 2)
INSERT INTO S1 VALUES(1, 2, 'a_', 'b3', 'c1', 5, 2)
INSERT INTO S1 VALUES(1, 3, 'a2', 'b1', 'c2', Null, 2)
INSERT INTO S1 VALUES(2, 1, 'a3','b3', 'c2', Null, 100)
INSERT INTO S1 VALUES(2, 2, 'a3', 'b3', 'c3', Null, 100)

SELECT DISTINCT FK1
FROM S1
--left join
SELECT *
FROM S1

SELECT *
FROM S1 s1 LEFT JOIN S1 s2 ON s1.FK1 = s2.E

--right join
SELECT *
FROM S1

SELECT *
FROM S1 s1 RIGHT JOIN S1 s2 ON s1.FK1 = s2.E

--inner join
SELECT *
FROM S1

SELECT DISTINCT *
FROM S1 s1 INNER JOIN S1 s2 ON s1.FK1 = s2.ESELECT *
FROM S1 s1 INNER JOIN S1 s2 ON s1.FK1 = s2.E--full joinSELECT *
FROM S1SELECT *
FROM S1 s1 FULL JOIN S1 s2 ON s1.FK1 = s2.E--cross join 5x5SELECT *
FROM S1SELECT *
FROM S1 s1 CROSS JOIN S1 s2--10SELECT FK2, FK1, COUNT(DISTINCT B)
FROM S1
GROUP BY FK2, FK1
HAVING FK1 = 0SELECT FK2, FK1, COUNT(C)
FROM S1
GROUP BY FK2, FK1
HAVING MAX(E) < 0


--II

CREATE TABLE R(
RID INT PRIMARY KEY,
A INT,
B INT,
C INT,
D INT,
E INT,
F INT)

INSERT INTO R VALUES(1, 100, 200, 5, 200, 20, 11)
INSERT INTO R VALUES(2, 101, 50, 11, 200, 5, 12)
INSERT INTO R VALUES(3, 100, 100, 7, 200, 5, 13)
INSERT INTO R VALUES(4, 200, 200, 6, 200, 20, 14)
INSERT INTO R VALUES(5, 200, 100, 2, 200, 5, 9)
INSERT INTO R VALUES(6, 300, 50, 11, 200, 5, 10)

SELECT r1.RID, r1.A + r2.A C2, r1.A * r2.A C3
FROM R r1 LEFT JOIN R r2 ON r1.RID = r2.RID
WHERE r1.A > ANY (SELECT B
FROM R
WHERE C < 10)


--4
--1256

--5
SELECT R.*
FROM
(SELECT r1.RID, r2.A, r3.B
FROM R r1 INNER JOIN R r2 ON r1.A = r2.B
INNER JOIN R r3 ON r2.B > r3.D
WHERE r1.F > 10) t
RIGHT JOIN R ON t.RID = R.RID
----TRY
SELECT *
FROM S

SELECT * 
FROM R 

SELECT *
FROM S FULL OUTER JOIN R ON S.FK1=R.RID

SELECT *
FROM S CROSS JOIN R

SELECT *
FROM S

SELECT * 
FROM R 


SELECT S.RID,S.A
FROM
(SELECT *
FROM R
WHERE F<13)S
INNER JOIN
(SELECT *
FROM R)R
ON S.D=R.D


SELECT A,B,C
FROM (


)

SELECT A,B,C
FROM
(SELECT A,B,RID
FROM R
WHERE E=70)A
INNER JOIN
(SELECT C,RID
FROM R
WHERE E>5)B
ON A.RID=B.RID